package main

import (
	"log"
	"github.com/widaT/damogo/pb"
	"context"
	"google.golang.org/grpc"
	"fmt"
	"time"
)

const (
	address     = "localhost:50051"
)
var feature =  []float32{-0.05625478386878967, 0.0500498004257679, -0.029762981459498405, 0.041925687342882156, 0.027605237439274788, -0.034265778958797455, -0.048352453857660294, 0.03331070765852928, -0.033542700111866, -0.04713825508952141, 0.03420078754425049, -0.07667610049247742, -0.024069519713521004, -0.015987182036042213, -0.0578911118209362, 0.039810001850128174, -0.06243816390633583, -0.019488325342535973, 0.006604105234146118, -0.018012257292866707, -0.03100457787513733, -0.042700543999671936, -0.020868811756372452, 0.030980315059423447, -0.09374792128801346, 0.0450451634824276, -0.04090619087219238, 0.0338844433426857, -0.009366867132484913, -0.09454930573701859, -0.0016941665671765804, 0.011982010677456856, -0.019632652401924133, -0.0777890682220459, -0.020744310691952705, -0.05210139974951744, 0.005281036254018545, -0.07610414177179337, 0.04839642718434334, -0.08146786689758301, -0.0007305734907276928, -0.0011992673389613628, 0.03575388342142105, -0.0005720336921513081, -0.06670810282230377, -0.04276517033576965, 0.11256980895996094, 0.05932892486453056, 0.005843814928084612, 0.029821686446666718, -0.08927275240421295, -0.08457691967487335, -0.026098759844899178, -0.014291021972894669, 0.01744765415787697, 0.03652196004986763, 0.020168736577033997, -0.028833672404289246, 0.04061344265937805, 0.08447081595659256, 0.07616124302148819, 0.06269749253988266, -0.0388253815472126, -0.007021589670330286, -0.04063272848725319, -0.04009858891367912, 0.009894506074488163, 0.011011824943125248, -0.01989820785820484, 0.004703855141997337, 0.02799166552722454, 0.017924219369888306, -0.030389780178666115, 0.026156358420848846, 0.06498396396636963, 0.06166563555598259, 0.020456288009881973, -0.018055755645036697, 0.025258591398596764, 0.038689471781253815, -0.017014121636748314, 0.013364514335989952, 0.0014492638874799013, -0.03296312317252159, -0.035034529864788055, 0.011066603474318981, -0.07558371126651764, -0.026886746287345886, -0.12362554669380188, 0.052791379392147064, -0.0024915023241192102, 0.02989399991929531, -0.022321300581097603, -0.050790634006261826, 0.02089015766978264, -0.015455278567969799, -0.012726189568638802, 0.01352942455559969, -0.003943393938243389, -0.021344859153032303, -0.033340971916913986, -0.07951179891824722, -0.0058465092442929745, 0.0332777164876461, -0.013627622276544571, 0.006932079792022705, -0.08566103875637054, -0.00913193542510271, 0.0036333680618554354, 0.0016716880491003394, -0.013652028515934944, -0.0562349371612072, -0.015906542539596558, 0.003112177364528179, 0.0034118168987333775, -0.007461000233888626, 0.0225372314453125, 0.005860289558768272, -0.06951212137937546, -0.046678245067596436, -0.023687291890382767, 0.007358870469033718, 0.04179229959845543, -0.02255973592400551, -0.036256093531847, -0.09916554391384125, 0.0013695888919755816, 0.008862077258527279, 0.05478747934103012, 0.016521738842129707, -0.04738496616482735, -0.02709271013736725, -0.019443001598119736, 0.08256582170724869, 0.04037046805024147, -0.002677005482837558, 0.061081405729055405, -0.004160268232226372, 0.016959799453616142, 0.07814070582389832, 0.0016886130906641483, -0.023164087906479836, 0.042470913380384445, 0.006858923006802797, -0.052162569016218185, 0.06168530508875847, -0.03338169679045677, -0.03268028795719147, 0.007139655761420727, -0.010314561426639557, -0.02457907423377037, 0.0015544630587100983, -0.04341473802924156, -0.021086914464831352, -0.038891009986400604, 0.023605607450008392, 0.06331263482570648, -0.015886956825852394, -0.056694816797971725, 0.015735642984509468, 0.00710117444396019, -0.020515475422143936, 0.038929808884859085, 0.016153117641806602, 0.045958779752254486, -0.02023237943649292, -0.005928273778408766, -0.0010867598466575146, 0.02280931919813156, -0.0040088677778840065, -0.005605204030871391, 0.027724936604499817, -0.04023017734289169, -0.007412294391542673, -0.011266972869634628, -0.032352644950151443, -0.008076387457549572, -0.059418775141239166, 0.03236822783946991, 0.018416743725538254, -0.041630711406469345, 0.008071374148130417, -0.06546419113874435, -0.029050635173916817, -0.0657515600323677, -0.005267242435365915, 0.09147237986326218, 0.059959396719932556, -0.054550085216760635, -0.02129574678838253, 0.01442860346287489, -0.025300906971096992, 0.05081825330853462, -0.011294982396066189, 0.09224681556224823, -0.06582912802696228, -0.032733745872974396, -0.03692195564508438, 0.037967830896377563, -0.02422618493437767, 0.0006432015798054636, 0.07878265529870987, 0.00959134940057993, -0.014421879313886166, -0.0031783119775354862, -0.023334188386797905, 0.04624425247311592, -0.01156370434910059, 0.0018651436548680067, 0.07796923071146011, -0.015616386197507381, 0.05344923213124275, 0.06688421219587326, 0.05434500798583031, 0.06323113292455673, -0.017195340245962143, 0.07066712528467178, -0.08374476432800293, -0.06671643257141113, 0.03655260056257248, -0.008624032139778137, 0.035837966948747635, -0.04060475528240204, -0.08518105000257492, 0.07746316492557526, -0.023628048598766327, 0.019497696310281754, 0.01931411772966385, -0.0009082612814381719, -0.05164303630590439, 0.023036396130919456, -0.002970945555716753, 0.04869526997208595, 0.07976258546113968, -0.038210898637771606, 0.020567167550325394, 0.015198045410215855, -0.08290455490350723, 0.03020576760172844, -0.008896338753402233, 0.0008888071170076728, 0.015378469601273537, 0.05693045258522034, 0.05115891620516777, 0.048890575766563416, 0.022083705291152, -0.00034911310649476945, 0.00415633013471961, 0.004339366685599089, -0.0038295970298349857, 0.0217509213835001, -0.011111592873930931, -0.017564568668603897, 0.05543062463402748, -0.08339279145002365, 0.028469420969486237, 0.031049884855747223, -0.05559143051505089, 0.040186163038015366, -0.04299355298280716, 0.045113105326890945, 0.08494816720485687, 0.012306520715355873, 0.001771646668203175, -0.0567743219435215, 0.011916403658688068, 0.022461311891674995, -0.03869906812906265, -0.016187340021133423, -0.01714082807302475, 0.018052009865641594, -0.027355026453733444, -0.028244204819202423, 0.0043469988740980625, 0.013064904138445854, -0.040446799248456955, 0.02520294114947319, -0.034958042204380035, 0.061674121767282486, -0.04909240081906319, -0.015544721856713295, -0.02752990461885929, -0.05711722746491432, -0.05515391379594803, -0.04694666713476181, -0.04475533589720726, 0.0016678252723067999, -0.019177885726094246, -0.04299655929207802, 0.043136484920978546, 0.041561778634786606, 0.028608212247490883, 0.024247298017144203, -0.01356880459934473, -0.019269650802016258, 0.09346406161785126, 0.007268741726875305, -0.006808624602854252, 0.0010038805194199085, -0.08401394635438919, -0.08575070649385452, 0.04030415788292885, 0.021087689325213432, 0.022787632420659065, -0.009946766309440136, -0.06611582636833191, -0.05727454274892807, -0.013254200108349323, 0.040303170680999756, -0.006937400903552771, -0.05572212487459183, -0.004774957429617643, 0.004758868832141161, -0.005612757056951523, -0.053002338856458664, 0.007421756628900766, -0.024998340755701065, -0.022584406659007072, -0.03931242600083351, 0.03903971239924431, 0.026416728273034096, -0.08845873177051544, -0.0022075120359659195, -0.04034080728888512, 0.023234974592924118, -0.06478219479322433, -0.046201687306165695, 0.05138750746846199, 0.017841653898358345, 0.06869757920503616, -0.039960335940122604, -0.0032628048211336136, -0.07884018123149872, 0.0038642347790300846, -0.02264704369008541, -0.05801708996295929, -0.017116915434598923, 0.050588272511959076, 0.17035962641239166, -0.015511954203248024, 0.0014067679876461625, -0.034066248685121536, -0.07943305373191833, 0.10010453313589096, -0.033055488020181656, -0.027722163125872612, -0.010343355126678944, -0.06594749540090561, 0.009208078496158123, 0.08289730548858643, 0.09083344787359238, -0.0796278640627861, -0.06148538365960121, -0.0025501400232315063, 0.04775504022836685, 0.040949683636426926, -0.0034013150725513697, 0.07502329349517822, 0.06629285216331482, 0.06659133732318878, -0.027400704100728035, 0.06164738908410072, 0.0008932625059969723, 0.017482265830039978, -0.0883195623755455, -0.009974879212677479, 0.0023678061552345753, 0.025833643972873688, 0.027081208303570747, 0.03857747092843056, 0.041340701282024384, -0.03212538734078407, 0.05471794679760933, 0.02481519989669323, -0.08281471580266953, -0.0023191189393401146, -0.015116708353161812, 0.01576237380504608, 0.01738084852695465, -0.00028301504789851606, 0.012270958162844181, -0.04416685551404953, 0.000804229115601629, -0.054706498980522156, -0.017925584688782692, 0.030086206272244453, 0.001187261426821351, -0.06806580722332001, 0.06308694928884506, 0.023382563143968582, -0.05891973152756691, 0.0455816388130188, 0.024449456483125687, -0.005009027663618326, 0.012603184208273888, -0.01178096141666174, 0.00827720109373331, 0.02401929348707199, 0.09296201169490814, 0.04752025380730629, 0.08107522130012512, 0.04412149265408516, 0.0008298851898871362, 0.05644521862268448, 0.005824549589306116, -0.038928065448999405, -0.0034553403966128826, 0.02214905247092247, 0.06010983884334564, 0.012369572184979916, 0.03578636795282364, 0.03239035978913307, 0.07049981504678726, -0.055260613560676575, -0.029437856748700142, 0.05445065721869469, 0.00582084758207202, -0.10849680006504059, 0.012100772932171822, -0.050700604915618896, -0.01218871958553791, -0.0473572313785553, -0.00559467077255249, -0.05831489711999893, 0.0028355715330690145, 0.029147135093808174, -0.04851608723402023, 0.01870843581855297, 0.04653763771057129, 0.08568350225687027, 0.03662564978003502, 0.004093598108738661, 0.04601547122001648, 0.01641666144132614, 0.07842251658439636, 0.06295592337846756, 0.053515855222940445, 0.03475363180041313, 0.08408361673355103, -0.03615524247288704, -0.06432590633630753, -0.05413105711340904, -0.04348593205213547, -0.03688507154583931, 0.05776205658912659, 0.05371551588177681, 0.05224519595503807, 0.024790680035948753, -0.09210054576396942, -0.02304413728415966, -0.03741999715566635, 0.016320159658789635, 0.032129596918821335, -0.017977068200707436, 0.023025773465633392, 0.06311535090208054, -0.04700998589396477, -0.05483776703476906, 0.005367042031139135, -0.11144855618476868, 0.04423384740948677, 0.01915496587753296, -0.07855203002691269, 0.016378071159124374, 0.07937026023864746, -0.019006455317139626, 0.04907992109656334, 0.026019591838121414, -0.09280004352331161, 0.028770925477147102, 0.02529861405491829, 0.003844618797302246, -0.06391968578100204, 0.07750510424375534, -0.0582810714840889, 0.05484028905630112, 0.046528518199920654, -0.02703634835779667, -0.010201173834502697, 0.027114955708384514, 0.04851224645972252, -0.014657408930361271, 0.02813987247645855, 0.04192311689257622, -0.07489914447069168, -0.05245377495884895, -0.029478425160050392, 0.0012054948601871729, -0.0635327696800232, -0.017214328050613403, -0.07338808476924896, 0.06106669083237648, -0.00931980088353157, -0.011258432641625404, 0.0052536120638251305, 0.022437311708927155, -0.02312489226460457, -0.07251066714525223, -0.028475802391767502, -0.027963975444436073, -0.02734806388616562, -0.04029250144958496, -0.011894461698830128, -0.01850057952105999, -0.011432012543082237, -0.0035759604070335627, 0.0073173437267541885, -0.012210069224238396, -0.013663328252732754, -0.010572290048003197, -0.02768370695412159, 0.0844249501824379}
func main() {
	// Set up a connection to the server.
	conn, err := grpc.Dial(address, grpc.WithInsecure())
	if err != nil {
		log.Fatalf("did not connect: %v", err)
	}
	defer conn.Close()
	c := pb.NewFacedbClient(conn)




	/*for i:=0;i<1000000;i++ {
		_, err := c.AddUser(context.Background(),&pb.UserInfo{Group:"tesst",Id:fmt.Sprintf("widaddd_%d",i),Feature:&pb.Feature{Feature:feature}})
		if err != nil {
			log.Fatalf("could not greet: %v", err)
		}
	}
*/

	ret, err := c.AddUser(context.Background(),&pb.UserInfo{Group:"aaaaaaa",Id:"widaddd",Feature:feature})
	if err != nil {
		log.Fatalf("could not greet: %v", err)
	}
	//log.Printf("Greeting: %s", r.Users)
	fmt.Println(ret)


	dd,err := c.GetUser(context.Background(),&pb.UserInfo{Group:"aaaaaaa",Id:"widaddd"})
	if err != nil {
		log.Fatalf("could not greet: %v", err)
	}
	fmt.Println(dd.GetFeature())
	stime := time.Now()
	r, err := c.Search(context.Background(), &pb.SearchRequest{Group:"tesst",Feature:feature})
	if err != nil {
		log.Fatalf("could not greet: %v", err)
	}
	fmt.Println(r,time.Now().Sub(stime))


	d,err:= c.DelUser(context.Background(),&pb.UserInfo{Group:"aaaaaaa",Id:"widaddd"})
	if err != nil {
		log.Fatalf("could not greet: %v", err)
	}
	fmt.Println(d)
}